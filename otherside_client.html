<!DOCTYPE html>
<html><head>

    <script src="js/lib/sockjs-0.3.js"></script>
    <script src="js/lib/stomp.js"></script>

<script>
    //use SockJS implementation instead of the browser's native implementation
    var ws = new SockJS('http://127.0.0.1:15674/stomp');
    var client = Stomp.over(ws);

	var on_connect = function() {
        console.log('connected');
        var mysubid = 'SubscriptionID_consumer2';
        var subscription = client.subscribe("/queue/example_QD1", callback, { id: mysubid });
        console.log('subscribed to ' + mysubid);
    };
    var on_error =  function() {
        console.log('error');
    };

    var callback = function(message) {
    // called when the client receives a STOMP message from the server
    if (message.body) {
      console.log("got message with body " + message.body)
    } else {
      console.log("got empty message");
    }
    };

    client.connect('test_user2', 'test', on_connect, on_error, '/');
    client.heartbeat.outgoing = 0;
    client.heartbeat.incoming = 0;


</script>


<script>



function sendUpdate() {
  var message = {command: "UPDATE"};
  client.send("/queue/example_QD2", {priority: 9}, JSON.stringify(message));
}
function send120Links() {
  for (var i = 0; i < 120; i++) {
    client.send("/queue/example_QD2", {priority: 9}, "120links");
}
client.send("/queue/example_QD2", {priority: 9}, "UPDATE");
  };
   
function sendNewRadio() {
   //client.send("/queue/example_QD2", {priority: 9}, "CMD:NEW_OBJECT;OBJ=[name,RadioFromMSG,type,Radio];PARENT=BTS2-1;VISIBLE=true;");
   var message = {command: "NEW_OBJECT", newObject: {name: "blaTEST", type: "Radio", groupable: true}, parent: "TG1-1"};
   client.send("/queue/example_QD2", {priority: 9}, JSON.stringify(message));

   var message2 = {command: "UPDATE"};
   client.send("/queue/example_QD2", {priority: 9}, JSON.stringify(message2));
}
function send50Radios() {
  for (var i = 0; i < 50; i++) {
    client.send("/queue/example_QD2", {priority: 9}, "NEW_RADIO");
  };
   
}

function sendDelete(){
  var message = {command: "DELETE", name: "blaTEST"};
  client.send("/queue/example_QD2", {priority: 9}, JSON.stringify(message));

  sendUpdate();
}

function sendMove(){
  var message = {command: "MOVE", name: "blaTEST", targetParent: "BTS2-5"};
  client.send("/queue/example_QD2", {priority: 9}, JSON.stringify(message));
  sendUpdate();

}

function sendAddLink(){
  var message = {command: "ADD_LINK", fromName: "System1", toName: "TG1-1", linkName:"linkBLA", linkColorIndex: 5, visible: true};
  client.send("/queue/example_QD2", {priority: 9}, JSON.stringify(message));
  sendUpdate();

}

function sendDelLink(){
  var message = {command: "DEL_LINK", linkName: "linkBLA" };
  client.send("/queue/example_QD2", {priority: 9}, JSON.stringify(message));
  sendUpdate();
}


function sendCombo(){

var message = {command: "NEW_OBJECT", newObject: {name: "blaTEST", type: "Radio", groupable: true}, parent: "BTS2-1"};
client.send("/queue/example_QD2", {priority: 9}, JSON.stringify(message));
sendUpdate();
  var message = {command: "MOVE", name: "blaTEST", targetParent: "BTS2-5"};
  client.send("/queue/example_QD2", {priority: 9}, JSON.stringify(message));

    var message = {command: "ADD_LINK", fromName: "blaTEST", toName: "TG1-1", linkName:"linkBLA", linkColorIndex: 5, visible: true};
  client.send("/queue/example_QD2", {priority: 9}, JSON.stringify(message));
  sendUpdate();

}

</script>

</head>

<body lang="en">
<h1>Clilent 2 TEST</h1>
<button onclick="sendCombo()">Combo</button>
<button onclick="sendUpdate()">Update</button>
<button onclick="send120Links()">120 Links</button>
<button onclick="sendNewRadio()">New radio</button>
<button onclick="send50Radios()">50 radios</button>
<button onclick="sendDelete()">Delete</button>
<button onclick="sendMove()">Move</button>
<button onclick="sendAddLink()">AddLink</button>
<button onclick="sendDelLink()">DelLink</button>


</body>