<!DOCTYPE html>
<html><head>

    <script src="js/lib/sockjs-0.3.js"></script>
    <script src="js/lib/stomp.js"></script>

<script>
    //use SockJS implementation instead of the browser's native implementation
    var ws = new SockJS('http://127.0.0.1:15674/stomp');
    var client = Stomp.over(ws);

	var on_connect = function() {
        console.log('connected');
        var mysubid = 'SubscriptionID_consumer2';
        var subscription = client.subscribe("/queue/example_QD1", callback, { id: mysubid });
        console.log('subscribed to ' + mysubid);
    };
    var on_error =  function() {
        console.log('error');
    };

    var callback = function(message) {
    // called when the client receives a STOMP message from the server
    if (message.body) {
      console.log("got message with body " + message.body)
    } else {
      console.log("got empty message");
    }
    };

    client.connect('test_user2', 'test', on_connect, on_error, '/');
    client.heartbeat.outgoing = 0;
    client.heartbeat.incoming = 0;


</script>


<script>
function sendTest1() {
   client.send("/queue/example_QD2", {priority: 9}, "Message1");
}
function sendTest2() {
  for (var i = 0; i < 120; i++) {
    client.send("/queue/example_QD2", {priority: 9}, "Message2");
}
client.send("/queue/example_QD2", {priority: 9}, "Message1");
  };
   
function sendTest3() {
   client.send("/queue/example_QD2", {priority: 9}, "CMD:NEW_OBJECT;OBJ=[name,RadioFromMSG,type,Radio];PARENT=BTS2-1;VISIBLE=true;");
   client.send("/queue/example_QD2", {priority: 9}, "Message1");
}
function sendNewRadio() {
  for (var i = 0; i < 50; i++) {
    client.send("/queue/example_QD2", {priority: 9}, "NEW_RADIO");
  };
   
}
</script>

</head>

<body lang="en">
<h1>Clilent 2 TEST</h1>
<button onclick="sendTest1()">Update</button>
<button onclick="sendTest2()">120 Links</button>
<button onclick="sendTest3()">New radio</button>
<button onclick="sendNewRadio()">50 radios</button>
</body>